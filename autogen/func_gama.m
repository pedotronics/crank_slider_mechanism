function [gama]= func_gama(q,dq)
%%%%%%  func_gama.m
%%%%  06-Sep-2014 20:04:46
%%%%
%%%% Authors(s): Pedotronics LLC
%%%%
%%%%
%%%%
%%%%
% Read model parameters
[r1,r2,e1,e2,e3,m1,m2,m3,J1,J2] = func_model_parameters;
X1 = q(1);
Y1 = q(2);
theta1 = q(3);
X2 = q(4);
Y2 = q(5);
theta2 = q(6);
X3 = q(7);
Y3 = q(8);
theta3 = q(9);
X4 = q(10);
Y4 = q(11);
theta4 = q(12);
dX1 = dq(1);
dY1 = dq(2);
dtheta1 = dq(3);
dX2 = dq(4);
dY2 = dq(5);
dtheta2 = dq(6);
dX3 = dq(7);
dY3 = dq(8);
dtheta3 = dq(9);
dX4 = dq(10);
dY4 = dq(11);
dtheta4 = dq(12);
gama = zeros(12,1);
gama(1)= dtheta1*(dtheta1*(X1*cos(theta1) - Y1*sin(theta1)) + dY1*cos(theta1) + dX1*sin(theta1)) + dY1*dtheta1*cos(theta1) + dX1*dtheta1*sin(theta1);
gama(2)= dtheta1*(dtheta1*(Y1*cos(theta1) + X1*sin(theta1)) - dX1*cos(theta1) + dY1*sin(theta1)) - dX1*dtheta1*cos(theta1) + dY1*dtheta1*sin(theta1);
gama(3)= 0;
gama(4)= dtheta2*(dtheta1*(Y2*sin(theta1 + theta2) - cos(theta1 + theta2)*(X2 - e1)) + dtheta2*(Y2*sin(theta1 + theta2) - cos(theta1 + theta2)*(X2 - e1)) - dY2*cos(theta1 + theta2) - dX2*sin(theta1 + theta2)) - dX2*(dtheta2*sin(theta1 + theta2) + dtheta1*(sin(theta1 + theta2) + e1*sin(theta1))) - dY2*(dtheta2*cos(theta1 + theta2) + dtheta1*(cos(theta1 + theta2) + e1*sin(theta1))) + dtheta1*(dtheta2*(Y2*sin(theta1 + theta2) - cos(theta1 + theta2)*(X2 - e1)) + dtheta1*(Y2*(sin(theta1 + theta2) - e1*cos(theta1)) - (X2 - e1)*(cos(theta1 + theta2) + e1*cos(theta1)) + X1*cos(theta1) - Y1*sin(theta1)) - dY2*(cos(theta1 + theta2) + e1*sin(theta1)) - dX2*(sin(theta1 + theta2) + e1*sin(theta1)) + dY1*cos(theta1) + dX1*sin(theta1)) + dY1*dtheta1*cos(theta1) + dX1*dtheta1*sin(theta1);
gama(5)= dX2*(dtheta1*(cos(theta1 + theta2) + e1*cos(theta1)) + dtheta2*cos(theta1 + theta2)) - dtheta2*(dtheta1*(Y2*cos(theta1 + theta2) + sin(theta1 + theta2)*(X2 - e1)) + dtheta2*(Y2*cos(theta1 + theta2) + sin(theta1 + theta2)*(X2 - e1)) - dX2*cos(theta1 + theta2) + dY2*sin(theta1 + theta2)) - dtheta1*(dtheta2*(Y2*cos(theta1 + theta2) + sin(theta1 + theta2)*(X2 - e1)) + dtheta1*(Y2*(cos(theta1 + theta2) + e1*sin(theta1)) - Y1*cos(theta1) - X1*sin(theta1) + (X2 - e1)*(sin(theta1 + theta2) + e1*sin(theta1))) - dX2*(cos(theta1 + theta2) + e1*cos(theta1)) + dY2*(sin(theta1 + theta2) - e1*cos(theta1)) + dX1*cos(theta1) - dY1*sin(theta1)) - dY2*(dtheta1*(sin(theta1 + theta2) - e1*cos(theta1)) + dtheta2*sin(theta1 + theta2)) - dX1*dtheta1*cos(theta1) + dY1*dtheta1*sin(theta1);
gama(6)= dY2*(dtheta2*cos(theta1 + theta2) + dtheta1*(cos(theta1 + theta2) + e1*sin(theta1))) - dY3*(dtheta3*cos(theta1 + theta3) + dtheta1*(cos(theta1 + theta3) + r1*sin(theta1)) + dtheta2*e2*sin(theta2)) + dX2*(dtheta2*sin(theta1 + theta2) + dtheta1*(sin(theta1 + theta2) + e1*sin(theta1))) - dX3*(dtheta3*sin(theta1 + theta3) + dtheta1*(sin(theta1 + theta3) + r1*sin(theta1)) + dtheta2*e2*sin(theta2)) + dtheta3*(dtheta1*(Y3*sin(theta1 + theta3) - cos(theta1 + theta3)*(X3 - e2)) + dtheta3*(Y3*sin(theta1 + theta3) - cos(theta1 + theta3)*(X3 - e2)) - dY3*cos(theta1 + theta3) - dX3*sin(theta1 + theta3)) - dtheta2*(dtheta1*(Y2*sin(theta1 + theta2) - cos(theta1 + theta2)*(X2 - e1 + r1)) - dX2*sin(theta1 + theta2) - dY2*cos(theta1 + theta2) + dtheta2*(Y2*sin(theta1 + theta2) - cos(theta1 + theta2)*(X2 - e1 + r1) + e2*cos(theta2)*(X3 - e2) + Y3*e2*cos(theta2)) + dX3*e2*sin(theta2) + dY3*e2*sin(theta2)) - dtheta1*(dY3*(cos(theta1 + theta3) + r1*sin(theta1)) - dY2*(cos(theta1 + theta2) + e1*sin(theta1)) - dtheta3*(Y3*sin(theta1 + theta3) - cos(theta1 + theta3)*(X3 - e2)) - dX2*(sin(theta1 + theta2) + e1*sin(theta1)) + dtheta2*(Y2*sin(theta1 + theta2) - cos(theta1 + theta2)*(X2 - e1 + r1)) + dtheta1*(Y2*(sin(theta1 + theta2) - e1*cos(theta1)) - Y3*(sin(theta1 + theta3) - r1*cos(theta1)) + (X3 - e2)*(cos(theta1 + theta3) + r1*cos(theta1)) - (cos(theta1 + theta2) + e1*cos(theta1))*(X2 - e1 + r1)) + dX3*(sin(theta1 + theta3) + r1*sin(theta1)));
gama(7)= dX3*(dtheta3*cos(theta1 + theta3) + dtheta1*(cos(theta1 + theta3) + r1*cos(theta1)) + dtheta2*e2*cos(theta2)) + dY2*(dtheta1*(sin(theta1 + theta2) - e1*cos(theta1)) + dtheta2*sin(theta1 + theta2)) - dY3*(dtheta3*sin(theta1 + theta3) + dtheta1*(sin(theta1 + theta3) - r1*cos(theta1)) - dtheta2*e2*cos(theta2)) - dtheta3*(dtheta1*(Y3*cos(theta1 + theta3) + sin(theta1 + theta3)*(X3 - e2)) + dtheta3*(Y3*cos(theta1 + theta3) + sin(theta1 + theta3)*(X3 - e2)) - dX3*cos(theta1 + theta3) + dY3*sin(theta1 + theta3)) + dtheta2*(dY2*sin(theta1 + theta2) - dX2*cos(theta1 + theta2) + dtheta1*(sin(theta1 + theta2)*(X2 - e1 + r1) + Y2*cos(theta1 + theta2)) + dtheta2*(sin(theta1 + theta2)*(X2 - e1 + r1) + Y2*cos(theta1 + theta2) - Y3*e2*sin(theta2) - e2*sin(theta2)*(X3 - e2)) + dX3*e2*cos(theta2) + dY3*e2*cos(theta2)) + dtheta1*(dX3*(cos(theta1 + theta3) + r1*cos(theta1)) - dX2*(cos(theta1 + theta2) + e1*cos(theta1)) - dtheta3*(Y3*cos(theta1 + theta3) + sin(theta1 + theta3)*(X3 - e2)) + dY2*(sin(theta1 + theta2) - e1*cos(theta1)) - dY3*(sin(theta1 + theta3) - r1*cos(theta1)) + dtheta2*(sin(theta1 + theta2)*(X2 - e1 + r1) + Y2*cos(theta1 + theta2)) + dtheta1*((sin(theta1 + theta2) + e1*sin(theta1))*(X2 - e1 + r1) + Y2*(cos(theta1 + theta2) + e1*sin(theta1)) - Y3*(cos(theta1 + theta3) + r1*sin(theta1)) - (X3 - e2)*(sin(theta1 + theta3) + r1*sin(theta1)))) - dX2*(dtheta1*(cos(theta1 + theta2) + e1*cos(theta1)) + dtheta2*cos(theta1 + theta2));
gama(8)= dY3*(dtheta3*cos(theta1 + theta3) + dtheta1*(cos(theta1 + theta3) + r1*sin(theta1)) + dtheta2*e2*sin(theta2)) - dtheta4*(dY4*cos(theta1 + theta4) + dX4*sin(theta1 + theta4) + dtheta1*(X4*cos(theta1 + theta4) - Y4*sin(theta1 + theta4)) + dtheta4*(X4*cos(theta1 + theta4) - Y4*sin(theta1 + theta4))) + dtheta3*(dY3*cos(theta1 + theta3) + dX3*sin(theta1 + theta3) - dtheta1*(Y3*sin(theta1 + theta3) - cos(theta1 + theta3)*(X3 - e2 + r2)) - dtheta3*(Y3*sin(theta1 + theta3) - cos(theta1 + theta3)*(X3 - e2 + r2))) - dY4*(dtheta4*cos(theta1 + theta4) + dtheta1*(cos(theta1 + theta4) + r1*sin(theta1)) + dtheta2*r2*sin(theta2)) + dX3*(dtheta3*sin(theta1 + theta3) + dtheta1*(sin(theta1 + theta3) + r1*sin(theta1)) + dtheta2*e2*sin(theta2)) - dX4*(dtheta4*sin(theta1 + theta4) + dtheta1*(sin(theta1 + theta4) + r1*sin(theta1)) + dtheta2*r2*sin(theta2)) + dtheta2*(dX3*e2*sin(theta2) + dY3*e2*sin(theta2) - dX4*r2*sin(theta2) - dY4*r2*sin(theta2) + dtheta2*cos(theta2)*(X3*e2 + Y3*e2 - X4*r2 - Y4*r2 + e2*r2 - e2^2)) - dtheta1*(dY4*(cos(theta1 + theta4) + r1*sin(theta1)) - dY3*(cos(theta1 + theta3) + r1*sin(theta1)) - dtheta1*((cos(theta1 + theta3) + r1*cos(theta1))*(X3 - e2 + r2) - X4*(cos(theta1 + theta4) + r1*cos(theta1)) - Y3*(sin(theta1 + theta3) - r1*cos(theta1)) + Y4*(sin(theta1 + theta4) - r1*cos(theta1))) + dtheta3*(Y3*sin(theta1 + theta3) - cos(theta1 + theta3)*(X3 - e2 + r2)) - dX3*(sin(theta1 + theta3) + r1*sin(theta1)) + dX4*(sin(theta1 + theta4) + r1*sin(theta1)) + dtheta4*(X4*cos(theta1 + theta4) - Y4*sin(theta1 + theta4)));
gama(9)= dX4*(dtheta4*cos(theta1 + theta4) + dtheta1*(cos(theta1 + theta4) + r1*cos(theta1)) + dtheta2*r2*cos(theta2)) - dX3*(dtheta3*cos(theta1 + theta3) + dtheta1*(cos(theta1 + theta3) + r1*cos(theta1)) + dtheta2*e2*cos(theta2)) - dtheta4*(dY4*sin(theta1 + theta4) - dX4*cos(theta1 + theta4) + dtheta1*(Y4*cos(theta1 + theta4) + X4*sin(theta1 + theta4)) + dtheta4*(Y4*cos(theta1 + theta4) + X4*sin(theta1 + theta4))) + dY3*(dtheta3*sin(theta1 + theta3) + dtheta1*(sin(theta1 + theta3) - r1*cos(theta1)) - dtheta2*e2*cos(theta2)) + dtheta3*(dY3*sin(theta1 + theta3) - dX3*cos(theta1 + theta3) + dtheta1*(sin(theta1 + theta3)*(X3 - e2 + r2) + Y3*cos(theta1 + theta3)) + dtheta3*(sin(theta1 + theta3)*(X3 - e2 + r2) + Y3*cos(theta1 + theta3))) + dtheta2*(dX4*r2*cos(theta2) - dY3*e2*cos(theta2) - dX3*e2*cos(theta2) + dY4*r2*cos(theta2) + dtheta2*sin(theta2)*(X3*e2 + Y3*e2 - X4*r2 - Y4*r2 + e2*r2 - e2^2)) - dY4*(dtheta4*sin(theta1 + theta4) + dtheta1*(sin(theta1 + theta4) - r1*cos(theta1)) - dtheta2*r2*cos(theta2)) + dtheta1*(dX4*(cos(theta1 + theta4) + r1*cos(theta1)) - dX3*(cos(theta1 + theta3) + r1*cos(theta1)) + dY3*(sin(theta1 + theta3) - r1*cos(theta1)) - dY4*(sin(theta1 + theta4) - r1*cos(theta1)) + dtheta3*(sin(theta1 + theta3)*(X3 - e2 + r2) + Y3*cos(theta1 + theta3)) + dtheta1*((sin(theta1 + theta3) + r1*sin(theta1))*(X3 - e2 + r2) + Y3*(cos(theta1 + theta3) + r1*sin(theta1)) - Y4*(cos(theta1 + theta4) + r1*sin(theta1)) - X4*(sin(theta1 + theta4) + r1*sin(theta1))) - dtheta4*(Y4*cos(theta1 + theta4) + X4*sin(theta1 + theta4)));
gama(10)= dtheta2*(dX4*r2*(X1*cos(theta1 - theta2) - Y1*sin(theta1 - theta2)) + dY4*r2*(X1*cos(theta1 - theta2) - Y1*sin(theta1 - theta2)) - dtheta1*r2*(Y1*cos(theta1 - theta2) + X1*sin(theta1 - theta2))*(X4 + Y4 + e3) + dtheta2*r2*(Y1*cos(theta1 - theta2) + X1*sin(theta1 - theta2))*(X4 + Y4 + e3) + dX1*r2*cos(theta1 - theta2)*(X4 + Y4 + e3) - dY1*r2*sin(theta1 - theta2)*(X4 + Y4 + e3)) - dtheta1*(dX4*r2*(X1*cos(theta1 - theta2) - Y1*sin(theta1 - theta2)) + dY4*r2*(X1*cos(theta1 - theta2) - Y1*sin(theta1 - theta2)) - dtheta1*r2*(Y1*cos(theta1 - theta2) + X1*sin(theta1 - theta2))*(X4 + Y4 + e3) + dtheta2*r2*(Y1*cos(theta1 - theta2) + X1*sin(theta1 - theta2))*(X4 + Y4 + e3) + dX1*r2*cos(theta1 - theta2)*(X4 + Y4 + e3) - dY1*r2*sin(theta1 - theta2)*(X4 + Y4 + e3)) - dY1*(dtheta2*(X4*r2*sin(theta1 - theta2) + Y4*r2*sin(theta1 - theta2) + e3*r2*sin(theta1 - theta2)) - dtheta1*(X4*r2*sin(theta1 - theta2) + Y4*r2*sin(theta1 - theta2) + e3*r2*sin(theta1 - theta2)) + dX4*(r1 + cos(theta4) + r2*cos(theta1 - theta2)) + dY4*(r1 - sin(theta4) + r2*cos(theta1 - theta2)) - dtheta4*(Y4*cos(theta4) + e3*cos(theta4) + X4*sin(theta4))) + dY4*(dtheta4*(Y1*cos(theta4) - X1*sin(theta4)) - dtheta1*(X1*r2*cos(theta1 - theta2) - Y1*r2*sin(theta1 - theta2)) + dtheta2*(X1*r2*cos(theta1 - theta2) - Y1*r2*sin(theta1 - theta2)) - dY1*(r1 - sin(theta4) + r2*cos(theta1 - theta2)) + dX1*(cos(theta4) - r2*sin(theta1 - theta2))) + dtheta4*(dX4*(X1*cos(theta4) + Y1*sin(theta4)) + dY4*(Y1*cos(theta4) - X1*sin(theta4)) - dtheta4*(Y1*e3*sin(theta4) + X1*Y4*cos(theta4) - X4*Y1*cos(theta4) + X1*e3*cos(theta4) + X1*X4*sin(theta4) + Y1*Y4*sin(theta4)) + dY1*(Y4*cos(theta4) + e3*cos(theta4) + X4*sin(theta4)) - dX1*(Y4*sin(theta4) - X4*cos(theta4) + e3*sin(theta4))) + dX1*(dtheta2*(X4*r2*cos(theta1 - theta2) + Y4*r2*cos(theta1 - theta2) + e3*r2*cos(theta1 - theta2)) - dtheta1*(X4*r2*cos(theta1 - theta2) + Y4*r2*cos(theta1 - theta2) + e3*r2*cos(theta1 - theta2)) + dY4*(cos(theta4) - r2*sin(theta1 - theta2)) + dX4*(sin(theta4) - r2*sin(theta1 - theta2)) - dtheta4*(Y4*sin(theta4) - X4*cos(theta4) + e3*sin(theta4))) + dX4*(dtheta4*(X1*cos(theta4) + Y1*sin(theta4)) - dY1*(r1 + cos(theta4) + r2*cos(theta1 - theta2)) - dtheta1*(X1*r2*cos(theta1 - theta2) - Y1*r2*sin(theta1 - theta2)) + dtheta2*(X1*r2*cos(theta1 - theta2) - Y1*r2*sin(theta1 - theta2)) + dX1*(sin(theta4) - r2*sin(theta1 - theta2)));
gama(11)= 0;
gama(12)= 0;